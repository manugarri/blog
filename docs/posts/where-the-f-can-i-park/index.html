<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>Where the f*** can I park? | Manugarri&#39;s blog</title>


<link rel="stylesheet" href="/blog/css/style.css"/><link rel='stylesheet' href='https://manugarri.github.io/blog/css/custom.css'><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
<script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="\/\/matomo.example.com\/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript>
  <img src="//matomo.example.com/piwik.php?idsite=1&amp;rec=1" style="border:0" alt="" />
</noscript>


<section class="section">
  <div class="container">
    <nav class="nav">
      <div class="nav-left">
        <a class="nav-item" href="https://manugarri.github.io/blog/"><h1 class="title is-4">Manugarri&#39;s blog</h1></a>
      </div>
      <div class="nav-right">
        <nav class="nav-item level is-mobile"><a class="level-item" aria-label="email" href='mailto:hola@manugarri.com' target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
    <polyline points="22,6 12,13 2,6"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="github" href='https://github.com/manugarri' target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="linkedin" href='https://linkedin.com/in/manuelgarridopena' target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path stroke-width="1.8" d="m5.839218,4.101561c0,1.211972 -0.974141,2.194011 -2.176459,2.194011s-2.176459,-0.982039 -2.176459,-2.194011c0,-1.211094 0.974141,-2.194011 2.176459,-2.194011s2.176459,0.982917 2.176459,2.194011zm0.017552,3.94922l-4.388022,0l0,14.04167l4.388022,0l0,-14.04167zm7.005038,0l-4.359939,0l0,14.04167l4.360816,0l0,-7.370999c0,-4.098413 5.291077,-4.433657 5.291077,0l0,7.370999l4.377491,0l0,-8.89101c0,-6.915523 -7.829986,-6.66365 -9.669445,-3.259423l0,-1.891237z"/>
    
  </svg></i>
            </span>
          </a><a class="level-item" aria-label="twitter" href='https://twitter.com/manugarri' target='_blank' rel='noopener'>
            <span class="icon">
              <i class><svg viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
    
    <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
    
  </svg></i>
            </span>
          </a></nav>
      </div>
    </nav>

    <nav class="nav">
      

      
    </nav>

  </div>
</section>

<section class="section">
  <div class="container">
    <div class="subtitle tags is-6 is-pulled-right">
      
    </div>
    <h2 class="subtitle is-6">February 21, 2016</h2>
    <h1 class="title">Where the f*** can I park?</h1>
    
    <div class="content">
      

<h3 id="tl-dr">TL;DR</h3>

<p>I made a map showing the different residential parking areas in my city.</p>

<p>It is the first map of this data that exists, and I am disappointed with the Spanish Government Open Data policies.</p>

<p>You can check out the map <a href="http://parking.manugarri.com" target="_blank">here</a>. I also shared the code required to create this map as a jupyter notebook <a href="https://gist.github.com/manugarri/404dde176ebeea41df50" target="_blank">here</a>.</p>

<h3 id="an-introduction-and-a-bit-of-ranting">An introduction, and a bit of ranting.</h3>

<p>After living in NYC for quite some time, I recently moved to Murcia, Spain to be closer to my family. I expected that, as with every time you move (and I have moved quite a bit over the years), there would be some administrative tasks that I would have to do: deal with things like immigration, housing, taxes, and other adult things.</p>

<p>Being accustomed to NYC bureaucracy, and complaining about it, I had absolutely forgotten how much worse bureaucratic processes are here in Spain.</p>

<p>I found out, that for most processes, the information is not clearly accesible online, and you have to either call to an office multiple times in hopes of someone picking up the phone, or even worse, <em>go phisically to an office just to ask what to do next time you go</em>. Sigh.</p>

<p>Those newyorkers reading this, I can tell you you guys are lucky, since everything you need to do for any bureocratic application in NYC being clearly explained in official governtment websites.</p>

<p>Of all the errands I had to do in order to settle in Spain, who would imagine that the most cumbersome process would be to get my parking permit.</p>

<p>See, in my hometown, there are certain parking spots that are reserved for those people living in the surrounding areas. The reason for this being  is that most building are old and have no underground parking. A parking license allows you to park in those reserved spots that are nearby your house.</p>

<p>These residence only parking areas are organized by zones, with a zone pass allowing you to park on that zone.</p>

<p>In order to get my parking license I had to go to 3 different government buildings on 4 different occasions. This was just ridiculous. But the most ridiculous thing was about to happen.</p>

<p>Once I got my residence card, I wanted to know where I could actually park, since the residential parking areas have no sign indicating which zone do they belong to.</p>

<p>This is how the conversation went.</p>

<p>Do you have a map showing streets where I can park?</p>

<p>No, I don&rsquo;t think there is a map.</p>

<p>Then how can I know if a parking area is part of my zone or not?</p>

<p>What we do have is a list of streets that we can give you.</p>

<p>What? Does that mean I have to keep this printed list in my car?</p>

<p>Well, what you can do is just check the permits on the other cars around you since the permit zone is written there.</p>

<p>So, in case you are as stunned as I was, here is what is going on in my hometown.</p>

<ol>
<li>There are some parking spots that are exclusively for people living in that area.</li>
<li>Parking there without the proper residence permit can get you fined (an undisclosed amount for what I know since there is no information online on the matter).</li>
<li>To be able to park in those spots you have to get a residence parking permit.</li>
<li>The process to get this permit is lengthy and cumbersome.</li>
<li>The permit allows you to park in those residential spots in that particular zone.</li>
<li>There is no map displaying which zone each street belongs to, only a list of street names.</li>
</ol>

<h3 id="the-list">The list</h3>

<p>Here is the list they gave me in all its glory:</p>

<p><img src="http://i.imgur.com/lKXIaQB.jpg" alt="Open data!" />
<div style="float: right">![]()</div>
<p style='text-align: center;margin-top: -20px;'><em>Open Data!</em></p></p>

<p>Basically, a list of street names, some with street numbers. No zipcode, no geographic denomination (e.g., square, street, etc) and no consistent formatting.</p>

<p>So until now, in 2016, the process to park in a residential spot goes as follows:</p>

<ol>
<li>Drive around until you find a parking spot.</li>
<li>Park.</li>
<li>Check the nearby cars to see if the parking zone in their permits matches yours.</li>
<li>Alternatively, find the street name and search for it in your paper list.</li>
<li>If the zone does not match yours, leave the parking spot and go to step 1.</li>
</ol>

<p>There are three things I found extremely ridiculous at this point.</p>

<ul>
<li><p>a) Given that these zones are marking streets surrounding where you live, <strong>this is probably the best example in the world of data that should be displayed on a map.</strong></p></li>

<li><p>b) Given that they assigned my parking zone based on where I live, <strong>there is already a government database matching locations with parking zones.</strong></p></li>

<li><p>c) Given a) and b), <strong>I find it embarrasing that my town has not yet created a map showing the parking zones</strong></p></li>
</ul>

<p>The solution was clear to me, <strong>I had to make the first residential parking zones map in my town</strong>.</p>

<h3 id="give-me-the-data">Give me the data</h3>

<p>In order to do the map, I had to get the street list for all the remaining zones.</p>

<p>To do so, I went once more time to the local town public office, got my turn, and waited until they called me.</p>

<p>I knew that telling the civil servant in charge the actual reason why I wanted the street lists for all the zones would not work, so I told her that my mom asked me to get the list for a friend of hers, and that she did not tell me the zone.</p>

<p>Then she tried and asked me where that woman lived, and I said I did not know.</p>

<p>After that, the public worker told me that they didn&rsquo;t usually share the zone streets lists with people who weren&rsquo;t residents in that zone.</p>

<p>I have to recognize that at this point I was feeling disappointed with my country, seeing how information that affected me on a daily basis was so hard to obtain. <em>These lists should be online available for anyone to see!</em>, I thought.</p>

<p>Finally, the public worker called her manager and after some minutes on the phone, she reluctantly printed all the street lists for me. Victory!</p>

<p><img src="http://i.imgur.com/rnBieBx.jpg" alt="Open data!" />
<div style="float: right">![]()</div>
<p style='text-align: center;margin-top: -20px;'><em>cha-chiiing!</em></p></p>

<p>Now that I had the list of streets for each zone, I had to get the geographic information for those streets so I could put them in a map.</p>

<p>To get Murcia&rsquo;s geo data, I went and submitted a <a href="https://github.com/mapzen/metroextractor-cities/pull/371" target="_blank">pull request</a> in the <a href="https://mapzen.com/data/metro-extracts/" target="_blank">Mapzen Metro extracts projetc</a>. After aproving your PR, OpenStreetMaps geojson data for the specific location you submit is available for downloading on their site.</p>

<h3 id="processing-the-data">Processing the data</h3>

<p>Part of the OSM geojson data contains geometries for each street in the city. However, given that the lists provided by the public worker were written by hand by who knows who, there were some discrepancies between the Mapzen street names and the list names.</p>

<p>Among other data issues, these were the most common ones.</p>

<ul>
<li><p>Plain typos. These errors are common when data is manually input.
For example, <em>Corregidor alonso fajardo</em> instead of <em>Regidor alonso fajardo</em></p></li>

<li><p>Wrong geographic entity definition. Specifying <em>Square x</em> instead of <em>street x</em>. For example, <em>PLAZA JOSE MARIA PARRAGA, 2</em> instead of <em>CALLE JOSE MARIA PARRAGA, 2</em></p></li>
</ul>

<p>To match the streets on the street lists with the OSM data, it took a while of manual data munging. I put all of the geojson street names and the street lists on a <a href="https://docs.google.com/spreadsheets/d/1tdlmli43oq1bFBf8n41XfdUouquXRA7RQKkQIF4CJ3c/edit?usp=sharing" target="_blank">google spreadsheet</a> and match them. Most were a perfect match while others I had to do a bit of manual search.</p>

<h3 id="making-the-map">Making the map</h3>

<p>So finally I got a file with the streets on each list and the associated osm street id.</p>

<p>To make the map, I used <a href="https://github.com/python-visualization/folium" target="_blank">Folium</a>, which is an excellent library on top of leaflet that makes very beautiful maps.</p>

<p>I wanted to plot not only the streets, but also display a nice marker with the name on the street. To do so I used <a href="https://github.com/geopy/geopy" target="_blank">geopy</a> to geocode the streets and plot them on the map.</p>

<p>I also used those points to calculate the borders of each parking zone, making it easier to differentiate between parking areas.</p>

<p>Once I plotted all the streets colored by which zone they fall into I realized quickly that something was wrong.</p>

<p><img src="http://i.imgur.com/u5RNsAA.png" alt="oops" /></p>

<p>The issue is, on the street lists there was no zipcode information , and there are multiple streets with the same name in the region belonging to different zipcodes. Thus I associated the street names with the wrong osm streets.</p>

<p>To fix this I just took the most common zipcode on each zone cluster and used it to geocode again those streets geocoded wrongly.</p>

<p>Finally, I got the map running!</p>

<p><img src="http://i.imgur.com/GIzMn0S.png" alt="Voila!" /></p>

<p>You can check out the map live <a href="http://parking.manugarri.com" target="_blank">here</a>. I have found it very useful when looking for places to park.</p>

<p>If you want to play with the code, you can check the notebook <a href="https://gist.github.com/manugarri/404dde176ebeea41df50" target="_blank">here</a>.</p>

<p>That&rsquo;s all, thanks for reading!</p>

<h4 id="update-feb-23">Update Feb 23</h4>

<p>It seems that there was already a <a href="https://www.eysamobile.com/eysaMobile/murcia.html" target="_blank">map</a> with parking zones information. Not a public one (I have no idea how they got the information), not an easy to find one, but hey, its something. Honestly, had I known it existed I wouldn&rsquo;t have gone through the process of making the map myself. But hey, as with any pet project, I got to learn about new technologies.</p>

      
      <div class="related">
</div>
      
    </div>
    
  </div>
</section>


<section class="section">
  <div class="container has-text-centered">
    <p></p>
    
      <p>Powered by <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/ribice/kiss">Kiss</a>.</p>
    
  </div>
</section>

</body>
</html>

